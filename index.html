<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>ëŒ€ì„±ì—¬ìê³ ë“±í•™êµ ê¸‰ì‹ ë©”ë‰´</title>
<style>
body {
font-family: 'Nanum Gothic', sans-serif;
background-color: #fffaf0; /* ë² ì´ì§€ ë°°ê²½ */
margin: 0;
padding: 10px;
display: flex;
justify-content: center;
align-items: center;
min-height: 100vh; /* í™”ë©´ ì „ì²´ ë†’ì´ í™•ë³´ */
}

.container {
background-color: white;
border-radius: 15px;
box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
padding: 20px;
width: 100%;
max-width: 380px;
box-sizing: border-box;
}

h1 {
color: #cc6699;
text-align: center;
font-size: 1.5rem;
margin-bottom: 10px;
}

.date-selector {
text-align: center;
margin-bottom: 20px;
}

input[type="date"] {
width: 180px; /* ìµœì†Œí™”ëœ ë‚ ì§œ ì„ íƒê¸° ë„ˆë¹„ */
padding: 8px;
border: 1px solid #ffb6c1;
border-radius: 10px;
font-size: 1rem;
background-color: #ffe4e1;
color: #333;
text-align: center;
}

.menu {
margin-bottom: 15px;
padding: 15px;
background-color: #ffe6e6;
border-radius: 10px;
}

.menu h2 {
color: #ff99aa;
font-size: 1.2rem;
margin-top: 0;
}

.menu-items {
list-style-type: none;
padding: 0;
}

.menu-items li {
margin-bottom: 5px;
padding: 8px;
background-color: #fff;
border-radius: 5px;
font-size: 0.9rem;
}

.loading {
text-align: center;
color: #cc6699;
font-weight: bold;
}

.visitor-counter {
text-align: center;
margin-top: 10px;
font-size: 0.9rem;
color: #cc6699;
}

/* ì£¼ì˜ ë¬¸êµ¬ ìŠ¤íƒ€ì¼ */
.notice {
margin-top: 10px;
font-size: 0.8rem;
color: #666;
text-align: center;
}

.notice a {
color: #cc6699;
text-decoration: none;
}

/* ëª¨ë°”ì¼ ëŒ€ì‘ ìŠ¤íƒ€ì¼ */
@media (max-width: 480px) {
h1 {
font-size: 1.4rem;
}
.menu h2 {
font-size: 1rem;
}
}
</style>
</head>
<body>
<div class="container">
<h1>ğŸ©·ëŒ€ì„±ì—¬ìê³ ë“±í•™êµğŸ©·</h1>
<h1>ğŸ´ê¸‰ì‹ ë©”ë‰´ğŸš</h1>

<!-- ë‚ ì§œ ì„ íƒ í•„ë“œ -->
<div class="date-selector">
<input type="date" id="datePicker">
</div>

<!-- ë¡œë”© ì¸ë””ì¼€ì´í„° -->
<div id="loadingIndicator" class="loading" style="display: none;">ë¡œë”© ì¤‘... â³</div>

<!-- ì ì‹¬ ë©”ë‰´ -->
<div class="menu">
<h2>ğŸ”…ì ì‹¬ ë©”ë‰´</h2>
<ul class="menu-items" id="lunchMenu"></ul>
</div>

<!-- ì„ì‹ ë©”ë‰´ -->
<div class="menu">
<h2>ğŸŒ›ì„ì‹ ë©”ë‰´</h2>
<ul class="menu-items" id="dinnerMenu"></ul>
</div>

<!-- ë°©ë¬¸ì ì¹´ìš´í„° (FreeCounter API) -->
<div class="visitor-counter">
            ğŸ‘©â€ğŸ“ ëˆ„ì  ë°©ë¬¸ì ìˆ˜: 
<div id="sfcngff3pgx6p5key1yamz9deppabaramxh"></div>
<script type="text/javascript" src="https://counter6.optistats.ovh/private/counter.js?c=ngff3pgx6p5key1yamz9deppabaramxh&down=async" async></script>
<noscript><a href="https://www.freecounterstat.com" title="web counter"><img src="https://counter6.optistats.ovh/private/freecounterstat.php?c=ngff3pgx6p5key1yamz9deppabaramxh" border="0" title="web counter" alt="web counter"></a></noscript>

</div>

<!-- ì£¼ì˜ ë¬¸êµ¬ -->
<div class="notice">
ì‹ë‹¨ì— ê´€í•œ ìì„¸í•œ ì •ë³´ëŠ” <a href="http://daesung.gen.hs.kr/xboard/board.php?tbnum=45" target="_blank">í•™êµí™ˆí”¼</a>ë¥¼ ì°¸ê³ í•˜ì„¸ìš”.
</div>
<p style="font-size: 0.8rem; color: gray; margin-top: 5px;">- ëŒ€ì„±ì—¬ê³ ì •ë³´ìƒ˜ ì œì‘ -</p>
</div>


<script>
const lunchMenu = document.getElementById('lunchMenu');
const dinnerMenu = document.getElementById('dinnerMenu');
const datePicker = document.getElementById('datePicker');
const loadingIndicator = document.getElementById('loadingIndicator');

const API_KEY = '92fde5e6854340a681f0c632a35cac3b';
const ATPT_OFCDC_SC_CODE = 'F10';
const SD_SCHUL_CODE = '7380063';

async function fetchMenuData(date) {
const formattedDate = date.replace(/-/g, '');
const url = `https://open.neis.go.kr/hub/mealServiceDietInfo?KEY=${API_KEY}&Type=json&ATPT_OFCDC_SC_CODE=${ATPT_OFCDC_SC_CODE}&SD_SCHUL_CODE=${SD_SCHUL_CODE}&MLSV_YMD=${formattedDate}`;

try {
const response = await fetch(url);
const data = await response.json();

if (data.mealServiceDietInfo) {
return data.mealServiceDietInfo[1].row;
} else {
throw new Error('ê¸‰ì‹ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.');
}
} catch (error) {
console.error('Error fetching menu:', error);
return [];
}
}

function displayMenu(menuData) {
lunchMenu.innerHTML = '';
dinnerMenu.innerHTML = '';

if (menuData.length === 0) {
lunchMenu.innerHTML = '<li>í•´ë‹¹ ë‚ ì§œì˜ ì¤‘ì‹ ë©”ë‰´ê°€ ì—†ìŠµë‹ˆë‹¤.</li>';
dinnerMenu.innerHTML = '<li>í•´ë‹¹ ë‚ ì§œì˜ ì„ì‹ ë©”ë‰´ê°€ ì—†ìŠµë‹ˆë‹¤.</li>';
return;
}

menuData.forEach(meal => {
const menuItems = meal.DDISH_NM.split('<br/>');
const menuList = meal.MMEAL_SC_NM === 'ì¤‘ì‹' ? lunchMenu : dinnerMenu;

menuItems.forEach(item => {
const li = document.createElement('li');
li.textContent = item.replace(/\([^)]*\)/g, '').trim();
menuList.appendChild(li);
});
});
}

async function updateMenu() {
const selectedDate = datePicker.value;
loadingIndicator.style.display = 'block';

const menuData = await fetchMenuData(selectedDate);
displayMenu(menuData);

loadingIndicator.style.display = 'none';
}

datePicker.valueAsDate = new Date();
datePicker.addEventListener('change', updateMenu);

updateMenu();
</script>
</body>
</html>
